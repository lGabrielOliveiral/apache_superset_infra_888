services:
  terraform:
    build:
      context: ../terraform
    working_dir: /workspace
    volumes:
      # CÃ³digo Terraform dentro do container
      - ../terraform:/workspace
      # State e arquivos persistentes
      - ../terraform/datafile:/datafile
    entrypoint: ["terraform"]

  ansible:
    build:
      context: ../ansible
    working_dir: /ansible
    volumes:
      # Playbooks, inventory etc.
      - ../ansible:/ansible
      # Artefatos persistentes (logs, outputs, etc.)
      - ../ansible/datafile:/datafile
      # Se precisar de SSH real, descomenta:
      # - ~/.ssh:/root/.ssh:ro
    entrypoint: ["ansible-playbook"]
